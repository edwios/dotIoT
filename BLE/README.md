# dotIoT - BLE Gateway
dotIoT project linking up Telldus Live! and Smartline Flow

This is an early trial linking up the Smartline Flow devices with the Telldus platform. The main objectives are:
1. Look into what is needed to facilitate this whole setup,
2. Create a path for the dotIoT A.I. core to include Smartline Flow items under her control,
3. Solve an immediate headache in my home where the automation interfers with people dynamics.

There are a few python scripts deveveloped to bring upon this integration. For usage instructions, run script with option --help :

- httpserver.py
	This script aimed to provide a simple and unsecured HTTP server to receive commands sent from the events created in Telldus Live!. These commands then translated into appropriate MQTT messages and sent to the MQTT broker.

- smartline.py
	This is a simple gateway constructed to listen to commands sent over MQTT and translate these commands into appropriate PDU of the Telink mesh, and send it out to the Smartline Flow devices.
	It can also be used to scan the BLE mesh network for devices to connected to. At the moment, only Telink mesh is supported.
	Example usage:
	    python3 ./smartline.py --shared house -a --mqtthost 127.0.0.1 wait

- leGateway.py
	This is a simple gateway constructed to gather some data from a BLE device and publish the data through MQTT to the MQTT broker.

## Smartline Flow Controls

The smartline.py script allows you to interact with and control the Smartline devices.

### Install

**You must have python3 and pip installed and accessible from the PATH.**

Run the install.sh script:

`./install.sh`

The install script will install the necessary apt packages as well as python packages.

### Run

By default, the MQTT broker is set to localhost in the start script. To use a different MQTT broker, either modify the start script or specify in the python command line.

A file called `house.bin` is also expected to be in the same directory of `smartline.py`. This file shall contains all the device information encrypted with a defult passcode of '00000'. This file can be generated by choosing Share from the Smartline Flow app and copy over the file, and rename it.

Type `python3 ./smartline.py --help` for non-default setup and detailed information including supported commands.

To run, enter:

`sudo ./start_ble_gateway.sh`

To run in debug mode:

`sudo ./start_ble_gateway.sh -v`

To see the various command line options:

`sudo ./start_ble_gateway.sh --help`

